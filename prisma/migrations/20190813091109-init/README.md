# Migration `20190813091109-init`

This migration has been generated by Rob Cameron at 8/13/2019, 9:11:09 AM.
You can check out the [state of the datamodel](./datamodel.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `typesponder_dev`.`Form`(`id` int NOT NULL DEFAULT 0 ,`uid` varchar(1000) NOT NULL DEFAULT '' ,`name` varchar(1000) NOT NULL DEFAULT '' ,`tag` varchar(1000) NOT NULL DEFAULT '' ,PRIMARY KEY (`id`));

CREATE TABLE `typesponder_dev`.`Question`(`id` int NOT NULL DEFAULT 0 ,`uid` varchar(1000) NOT NULL DEFAULT '' ,`type` varchar(1000) NOT NULL DEFAULT '' ,`text` varchar(1000) NOT NULL DEFAULT '' ,`createdAt` datetime(3) NOT NULL  ,`updatedAt` datetime(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,PRIMARY KEY (`id`));

CREATE TABLE `typesponder_dev`.`Answer`(`id` int NOT NULL DEFAULT 0 ,`text` varchar(1000) NOT NULL DEFAULT '' ,`createdAt` datetime(3) NOT NULL  ,`updatedAt` datetime(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,PRIMARY KEY (`id`));

CREATE TABLE `typesponder_dev`.`Response`(`id` int NOT NULL DEFAULT 0 ,`uid` varchar(1000) NOT NULL DEFAULT '' ,`submittedAt` datetime(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,`createdAt` datetime(3) NOT NULL  ,`updatedAt` datetime(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,PRIMARY KEY (`id`));

CREATE TABLE `typesponder_dev`.`User`(`id` int NOT NULL DEFAULT 0 ,`email` varchar(1000) NOT NULL DEFAULT '' ,`createdAt` datetime(3) NOT NULL  ,`updatedAt` datetime(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,PRIMARY KEY (`id`));

CREATE TABLE `typesponder_dev`.`Note`(`id` int NOT NULL DEFAULT 0 ,`text` varchar(1000) NOT NULL DEFAULT '' ,PRIMARY KEY (`id`));

ALTER TABLE `typesponder_dev`.`Question` ADD COLUMN `form` int  ,ADD FOREIGN KEY (`form`) REFERENCES `typesponder_dev`.`Form`(`id`);

ALTER TABLE `typesponder_dev`.`Answer` ADD COLUMN `question` int  ,ADD FOREIGN KEY (`question`) REFERENCES `typesponder_dev`.`Question`(`id`),ADD COLUMN `response` int  ,ADD FOREIGN KEY (`response`) REFERENCES `typesponder_dev`.`Response`(`id`);

ALTER TABLE `typesponder_dev`.`Response` ADD COLUMN `form` int  ,ADD FOREIGN KEY (`form`) REFERENCES `typesponder_dev`.`Form`(`id`),ADD COLUMN `user` int  ,ADD FOREIGN KEY (`user`) REFERENCES `typesponder_dev`.`User`(`id`);

ALTER TABLE `typesponder_dev`.`Note` ADD COLUMN `user` int NOT NULL ,ADD FOREIGN KEY (`user`) REFERENCES `typesponder_dev`.`User`(`id`);

CREATE UNIQUE INDEX `Form.id._UNIQUE` ON `typesponder_dev`.`Form`(`id`)

CREATE UNIQUE INDEX `Form.uid._UNIQUE` ON `typesponder_dev`.`Form`(`uid`)

CREATE UNIQUE INDEX `Question.id._UNIQUE` ON `typesponder_dev`.`Question`(`id`)

CREATE UNIQUE INDEX `Question.uid._UNIQUE` ON `typesponder_dev`.`Question`(`uid`)

CREATE UNIQUE INDEX `Answer.id._UNIQUE` ON `typesponder_dev`.`Answer`(`id`)

CREATE UNIQUE INDEX `Response.id._UNIQUE` ON `typesponder_dev`.`Response`(`id`)

CREATE UNIQUE INDEX `Response.uid._UNIQUE` ON `typesponder_dev`.`Response`(`uid`)

CREATE UNIQUE INDEX `User.id._UNIQUE` ON `typesponder_dev`.`User`(`id`)

CREATE UNIQUE INDEX `User.email._UNIQUE` ON `typesponder_dev`.`User`(`email`)

CREATE UNIQUE INDEX `Note.id._UNIQUE` ON `typesponder_dev`.`Note`(`id`)
```

## Changes

```diff
diff --git datamodel.mdl datamodel.mdl
migration ..20190813091109-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,65 @@
+datasource db {
+  provider = env("PRISMA_PROVIDER")
+  url      = env("PRISMA_URL")
+}
+
+generator photon {
+  provider = "photonjs"
+  platforms = ["native", "linux-glibc-libssl1.0.2"]
+  output    = "../functions/generated/photon"
+}
+
+model Form {
+  id        Int     @id @unique
+  uid       String  @unique
+  name      String
+  tag       String
+  questions Question[]
+  responses Response[]
+}
+
+model Question {
+  id        Int      @id @unique
+  uid       String   @unique
+  type      String
+  text      String
+  form      Form?
+  answers   Answer[]
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Answer {
+  id        Int      @id @unique
+  text      String
+  question  Question?
+  response  Response?
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Response {
+  id          Int      @id @unique
+  uid         String   @unique
+  submittedAt DateTime
+  user        User?
+  form        Form?
+  answers     Answer[]
+  createdAt   DateTime @default(now())
+  updatedAt   DateTime @updatedAt
+}
+
+model User {
+  id        Int      @id @unique
+  email     String   @unique
+  responses Response[]
+  note      Note?
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Note {
+  id   Int @id @unique
+  text String
+  user User
+}
```

## Photon Usage

You can use a specific Photon built for this migration (20190813091109-init)
in your `before` or `after` migration script like this:

```ts
import Photon from '@generated/photon/20190813091109-init'

const photon = new Photon()

async function main() {
  const result = await photon.users()
  console.dir(result, { depth: null })
}

main()

```
